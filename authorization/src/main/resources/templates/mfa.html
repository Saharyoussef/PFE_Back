<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en" class="bg-gray-100">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Wevioo | Enter QR Code</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
<nav style="background-color: #4A1971"; class="fixed w-full top-0 left-0 z-40">
    <div class="container h-16 mx-auto">
        <div class="relative h-16 flex items-center justify-between">
            <div class="flex flex-1 items-center justify-center sm:items-stretch sm:justify-start">
                <a href="http://localhost:3001" class="flex-shrink-0 items-center cursor-pointer">
                    <img class="w-24 h-24" th:src="@{/photos/logo.png}" alt="Wevioo">
                </a>
            </div>
            <div class="flex items-center">
                <a href="http://localhost:8083/oauth2/authorize?response_type=code&client_id=client&scope=openid&redirect_uri=http://localhost:3001&code_challenge_method=S256&code_challenge=_NLVoFu5qTUtGyZ7sUDBnbHjqk3HGGmGbPbjK_wIKzg" class="bg-purple-900 p-1 text-white hover:text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-3">
                    Login
                    <svg xmlns="http://www.w3.org/2000/svg" stroke-linejoin="round" stroke-linecap="round" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="shrink-0 size-4"><path d="m15 4.5 7.5 7.5-7.5 7.5" /></svg>
                </a>
                <a href="http://localhost:3001/register" class="hover:bg-purple-900 relative p-1 text-white hover:text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-3">
                    Register
                    <svg xmlns="http://www.w3.org/2000/svg" stroke-linejoin="round" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke="currentColor" class="shrink-0 size-4"><path d="m15 4.5 7.5 7.5-7.5 7.5" /></svg>
                </a>
                <a href="http://localhost:3001/resetpassword" class="hover:bg-purple-900 relative p-1 text-white hover:text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center mr-3">
                    Reset Password
                    <svg xmlns="http://www.w3.org/2000/svg" stroke-linejoin="round" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke="currentColor" class="shrink-0 size-4"><path d="m15 4.5 7.5 7.5-7.5 7.5" /></svg>
                </a>
            </div>
        </div>
    </div>
</nav>

<div class="mt-12">
    <div class="container mx-auto pt-10">
        <div class="mt-4 flex flex-col items-center">
            <h2 class="text-2xl font-bold text-gray-800">Enter QR Code</h2>
        </div>
        <div class="mt-4 flex flex-col items-center">
            <div class="min-w-[30rem] p-4 rounded-lg p-3 border border-gray-200 bg-white">
                <div th:if="${session.SPRING_SECURITY_LAST_EXCEPTION != null}" class="flex items-center p-4 mb-4 text-red-800 rounded-lg bg-red-50" id="alert" role="alert">
                    <svg class="flex-shrink-0 w-4 h-4 mr-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                    </svg>
                    <div class="w-96 text-sm font-medium" data-th-text="${session.SPRING_SECURITY_LAST_EXCEPTION.message}">Invalid QR code. Please try again.</div>
                    <button type="button" class="ms-auto -mx-1.5 -my-1.5 bg-red-50 text-red-500 rounded-lg focus:ring-2 focus:ring-red-400 p-1.5 hover:bg-red-200 inline-flex items-center justify-center h-8 w-8" data-dismiss-target="#alert" aria-label="Close">
                        <span class="sr-only">Close</span>
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                    </button>
                </div>
                <form method="post" th:action="@{/mfa}">
                    <div class="space-y-6">
                        <div>
                            <label for="code" class="block mb-2 text-sm font-medium text-gray-800" data-th-text="${'Enter QR Code for ' + email}">Enter QR Code</label>
                            <input type="code" name="code" id="code" class="border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-purple-500 focus:border-purple-500 block w-full p-2.5" placeholder="123456" required />
                        </div>
                        <button type="submit" class="w-full text-white bg-purple-800 hover:bg-purple-900 focus:ring-4 focus:outline-none focus:ring-purple-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center">Verify QR Code</button>
                    </div>
                </form>
                <div class="mt-4">
                    <a href="http://localhost:3001/resetpassword" class="block mt-4 text-base text-purple-800 hover:underline">Forgot Password?</a>
                    <div class="mt-3 flex items-center justify-between">
                        <a href="http://localhost:3001/register" class="bg-purple-800 hover:bg-purple-900 p-2 rounded-md text-white block text-sm text-purple-800">Create account</a>
                        <a href="http://localhost:3001" class="inline-flex justify-center items-center bg-purple-800 hover:bg-purple-900 p-2 rounded-md text-white block text-sm text-purple-800">
                            Back to home
                            <svg xmlns="http://www.w3.org/2000/svg" stroke-linejoin="round" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke="currentColor" class="shrink-0 size-4">
                                <path d="m15 4.5 7.5 7.5-7.5 7.5" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.3.0/flowbite.min.js"></script>
</body>
</html>